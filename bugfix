added bug fix changes into this commit
